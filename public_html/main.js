function copyToClipboard(){}String.prototype.splice||(String.prototype.splice=function(t,e,n){return this.slice(0,t)+n+this.slice(t+Math.abs(e))}),window.urlParams=new URLSearchParams(window.location.search);const IS_STAGING=!!window.location.href.match(/https:\/\/staging.entropygames.io(\/.*)*$/),SITE_ROOT=`https://${IS_STAGING?"staging.":""}entropygames.io`;window.session=sessionStorage.getItem((IS_STAGING?"staging-":"")+"session-id")||-1;const STAGING_SERVER_PORT=30005,PROD_SERVER_PORT=30004,SERVER_PORT=IS_STAGING?30005:30004,thisScript=document.getElementsByTagName("script")[0],cacheBust=IS_STAGING?(Math.random()+1).toString(36).substring(7):"0";function loadScript(t,e=!0){return new Promise((n=>{const o=document.createElement("script");e&&o.setAttribute("type","module"),o.readyState?o.onreadystatechange=function(){"loaded"!==o.readyState&&"complete"!==o.readyState||(o.onreadystatechange=null,n())}:o.onload=n,o.src=t,document.getElementsByTagName("head")[0].appendChild(o)}))}function loadURLParamScripts(){return new Promise((async t=>{const e=thisScript.getAttribute("scripts");if(e)for(const t of e.split(","))await loadScript(t+"?x="+cacheBust);t()}))}function addNavAndFooter(){return new Promise((t=>{$("nav").load(`${SITE_ROOT}/nav.html?x=${cacheBust}`,(()=>{$("footer").load(`${SITE_ROOT}/footer.html?x=${cacheBust}`,(()=>{t()}))}))}))}function loadStyle(t){return new Promise((e=>{const n=document.getElementsByTagName("head")[0],o=document.createElement("link");o.setAttribute("rel","stylesheet"),o.setAttribute("href",`${t}?x=${cacheBust}`),n.appendChild(o),o.onload=e}))}function loadURLParamStyles(){return new Promise((async t=>{const e=thisScript.getAttribute("styles");if(e)for(const t of e.split(","))await loadStyle(t);t()}))}function setHREFsStaging(){const t=document.getElementsByTagName("a");for(const e of t)e.href.match(/https:\/\/entropygames.io(\/.*)*$/)&&(e.href=e.href.splice(8,0,"staging."))}function networkError(){if(console.log("Can't connect to the server!"),"0"==thisScript.getAttribute("doNetworkError"))return;let t=window.location.href;window.location.href=SITE_ROOT+"/error?type=serverConnection&cb="+encodeURIComponent(t)}async function testConnection(){try{(await request("ping").catch(networkError)).ok||networkError()}catch(t){networkError()}}function timeConnection(){!async function(){const t=performance.now();for(let t=0;t<20;t++)await request("ping");const e=performance.now()-t;console.log(`Server Ping: ${(e/20).toFixed(1)}ms (avg of 20)`)}()}function main(){return document.body.style.backgroundColor="#000",new Promise((async(t,e)=>{let n=0;loadStyle(SITE_ROOT+"/style.css").then((async()=>{await loadURLParamStyles(),n++,n>=3&&t()})),testConnection().then((async()=>{await request("log-visit",{url:window.location.pathname,time:new Date,timezone:(new Date).getTimezoneOffset()/60,from:document.referrer,browser:navigator.userAgent}),n++,n>=3&&t()})),await loadScript(SITE_ROOT+"/$.js",!1),await addNavAndFooter(),await loadURLParamScripts(),IS_STAGING&&(setHREFsStaging(),timeConnection()),n++,n>=3&&t()}))}window.request=async function(t,e={}){let n=await fetch(`https://entropygames.io:${SERVER_PORT}/${t}`,{method:"POST",body:JSON.stringify({...e,session:window.session})}).catch(networkError);try{return await n.json()}catch(e){return console.log(`request to '${t}' failed: ${e}`),{}}},window.onload=main;var randomString=function(){var t=("undefined"!=typeof self&&(self.crypto||self.msCrypto)?function(){var t=self.crypto||self.msCrypto;return function(e){for(var n=new Uint8Array(e),o=0;o<e;o+=65536)t.getRandomValues(n.subarray(o,o+Math.min(e-o,65536)));return n}}:function(){return require("crypto").randomBytes})(),e=function(e){if(e.length<2)throw new Error("charset must have at least 2 characters");var n=function(o){if(!o)return n.entropy(128);for(var r="",a=e.length,s=256-256%a;o>0;)for(var i=t(Math.ceil(256*o/s)),c=0;c<i.length&&o>0;c++){var l=i[c];l<s&&(r+=e.charAt(l%a),o--)}return r};return n.entropy=function(t){return n(Math.ceil(t/(Math.log(e.length)/Math.LN2)))},n.charset=e,n},n="0123456789",o="abcdefghijklmnopqrstuvwxyz",r={numeric:n,hex:n+"abcdef",alphalower:o,alpha:o+o.toUpperCase(),alphanumeric:n+o+o.toUpperCase(),base64:n+o+o.toUpperCase()+"+/",url:n+o+o.toUpperCase()+"-_"};const a=e(r.alphanumeric);for(let t in r)a[t]=e(r[t]);return a.custom=e,a}();function randomInt(t,e){const n=Math.ceil(t),o=Math.floor(e);return Math.floor(Math.random()*(o-n)+n)}